---
import data from "../../data/historia.json";
import Container from "../reutilizables/Container.astro";
import textGrid from "../../data/textGrid.json";
import { WidScrollReveal } from "../react_components/wid/WidScrollReveal";
---

<section
  id="wid"
  class="z-10 relative w-full h-auto place-content-center mx-auto overflow-hidden bg-[#fff5eb]"
  data-aos="fade-up"
  data-aos-duration="800"
  data-aos-once="true"
>
  <div
    class="wid relative w-full h-auto place-content-center mx-auto overflow-hidden rounded-[60px] md:rounded-[100px] bg-slate-600"
  >
    <div class="">
      <img
        loading="lazy"
        class="hidden md:block w-auto h-[calc(100%/2)] absolute top-0 -left-1 translate-y-[-50%] opacity-30 z-[1]"
        src="/resources/medio-espiral.svg"
        alt="medio espiral rojo"
        height="1"
        width="1"
      />
    </div>

    <div>
      <img
        loading="lazy"
        class="hidden lg:block w-auto h-[calc(100%/4)] absolute bottom-0 -right-2 opacity-60"
        src="/resources/media-caña.svg"
        alt="media caña verde"
        height="1"
        width="1"
      />
    </div>

    <Container>
      <div class="mx-auto w-full mt-10">
        <div class="hidden relative z-20 md:grid w-full place-content-center">
          <div
            class="mt-10 py-10 w-full backdrop-blur-sm bg-lcsPink1/20 rounded-[20px] cursor__personalizado"
          >
            <WidScrollReveal client:only="react" />
          </div>
        </div>

        <div
          class="w-full md:hidden flex flex-col justify-center items-center gap-4 mt-10 relative z-10"
        >
          <div class="texto">
            <p>{textGrid.text1}</p>
            <p>{textGrid.text2}</p>
          </div>
          <img
            loading="lazy"
            class="w-[80%] h-auto mx-auto rounded-[20px]"
            src="/img/wid1.avif"
            alt="Foto sentada en escritorio de La Chica del Seguro"
            height="1"
            width="1"
          />
          <div class="texto">
            <p>{textGrid.text3}</p>
            <p>{textGrid.text4}</p>
          </div>
        </div>

        <div class="w-full flex justify-center items-center my-14 z-10">
          <div
            class="flex flex-col md:flex-row justify-center gap-4 md:gap-8 items-center w-full md:w-[70%]"
          >
            <div class="bg-[#fef0e9] rounded-full overflow-hidden min-w-fit">
              <img
                loading="lazy"
                class="object-cover w-[150px] h-[150px]"
                src="/img/e-cute.avif"
                alt="emoji cute de La Chica del Seguro"
                height="1"
                width="1"
              />
            </div>

            <div
              class="grid place-items-center w-auto md:flex flex-wrap lg:w-[90%] xl:w-[70%] gap-x-3"
            >
              {
                data.map((item, index) => {
                  return (
                    <span
                      class="text-gray-50 text-[clamp(16px,2.1vw,18px)] 
                historia-item opacity-30 flex items-center gap-2 whitespace-nowrap text-wrap md:text-nowrap text-center "
                    >
                      {item.text}
                      {index !== data.length - 1 && (
                        <img
                          loading="lazy"
                          class="hidden md:block h-[clamp(15px,2.1vw,18px)] min-w-[13px]"
                          src="/resources/flecha-texto.svg"
                          alt="flecha texto"
                          height="1"
                          width="1"
                        />
                      )}{" "}
                    </span>
                  );
                })
              }
            </div>
          </div>
        </div>
      </div>
    </Container>
  </div>
  <style>
    .wid {
      background-image: linear-gradient(180deg, #518d87 33%, #c86363 100%);
    }
    .texto {
      padding-inline: 5px;
      width: 100%;
      font-size: 16px;
      font-weight: 300;
      color: azure;
      text-align: left;
      text-wrap: pretty;
    }
    .texto :nth-child(1) {
      margin-bottom: 16px;
    }

    .historia-item-animation {
      opacity: 0.3;
      animation: animationHistoria 3s ease-in-out infinite;
    }

    @keyframes animationHistoria {
      0% {
        opacity: 0.3;
      }
      20% {
        opacity: 1;
      }
      80% {
        opacity: 1;
      }

      100% {
        opacity: 0.3;
      }
    }

    .over-word {
      overflow-wrap: anywhere;
    }
    .cursor__personalizado {
      cursor: url("/resources/scroll-icon.svg"), auto;
    }
  </style>
  <script>
    import AOS from "aos";
    import "aos/dist/aos.css"; // You can also use <link> for styles
    // ..
    AOS.init();

    document.addEventListener("astro:page-load", () => {
      const historiaItems = document.querySelectorAll(".historia-item");
      let currentIndex = 0;

      function animateItems() {
        historiaItems.forEach((item, index) => {
          item.classList.remove("historia-item-animation");
          if (index === currentIndex) {
            item.classList.add("historia-item-animation");
          }
        });

        currentIndex = (currentIndex + 1) % historiaItems.length;
      }

      setInterval(animateItems, 3000);
      animateItems();
    });
  </script>
</section>

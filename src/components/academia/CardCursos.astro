---
import proximamente from "@/assets/img_academia/proximamente.avif";

interface Props {
  estado?: string;
  titulo: string;
  descripcion: string;
  img_curso: string;
  url_curso: string;
}
const { estado, titulo, descripcion, img_curso, url_curso } = Astro.props;
---

<div
  class="card relative w-full flex flex-col justify-between items-center shadow-[10px_10px_0px_#857993] max-w-[400px]"
  data-state={estado ? estado : "active"}
>
  <div
    class="proximamente z-10 w-full h-full top-0 left-0 bg-cover bg-center bg-no-repeat"
    style=`background-image: url(${proximamente.src});`
  >
  </div>

  <div
    class="card_img w-full h-[450px] xl:h-[500px] bg-center bg-no-repeat bg-cover"
    style=`background-image: url(${img_curso});`
  >
  </div>
  <div
    class="descripcion relative h-[200px] xl:h-[250px] w-full px-4 flex flex-col justify-center items-start gap-2 bg-black bg-opacity-5"
  >
    <span
      class="text-[clamp(18.5px,1vw,28px)] grid place-items-center font-bold text-academia-negro bg-academia-amarillo1 skew-x-[30deg] w-[90%] absolute -top-4 left-1/2 -translate-x-1/2"
    >
      <p class="-skew-x-[30deg]">{titulo}</p>
    </span>
    <span
      class="text-[clamp(1rem,1.2vw,1.2rem)] tracking-tight leading-tight mt-2"
    >
      {descripcion}
    </span>
    <span class="flex justify-end items-center w-full mt-4">
      <a
        href=`${url_curso}`
        class="bg-academia-violeta1 px-8 py-2 text-gray-50 font-normal text-xl shadow-academia-boton hover:translate-x-[5px] hover:translate-y-[5px] hover:shadow-none transition-all duration-300 ease-in"
        >Adquirir</a
      >
    </span>
  </div>
</div>

<script>
  document.addEventListener("astro:page-load", () => {
    const cards = document.querySelectorAll(".card");

    cards.forEach((card: HTMLElement) => {
      const estado = card.dataset.state;

      if (estado === "inactive") {
        // Solo selecciona los elementos dentro de esta tarjeta
        const proximamenteEls = card.querySelectorAll(".proximamente");
        const descripcion = card.querySelector(".descripcion");
        const cardImg = card.querySelector(".card_img");

        // Agrega la clase `absolute` solo si estÃ¡ inactiva
        proximamenteEls.forEach((el) => {
          el.classList.add("absolute");
        });

        if (cardImg) {
          cardImg.classList.add("grayscale", "opacity-50");
        }

        if (descripcion) {
          descripcion.classList.add("grayscale", "opacity-50");
        }
      }
    });
  });
</script>
